// Datastar v1.0.0-RC.12
var Ve=/ðŸ–•JS_DSðŸš€/.source,ie=Ve.slice(0,5),Se=Ve.slice(4),L="datastar",Ne="Datastar-Request",je=1e3;var qe=!1,Re="outer",Ge="inner",We="remove",Ke="replace",Ue="prepend",Be="append",Je="before",ze="after",Qe=Re,J="datastar-patch-elements",z="datastar-patch-signals";var j=e=>e!==null&&typeof e=="object"&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null);function Ze(e){for(let t in e)if(Object.hasOwn(e,t))return!1;return!0}function Q(e,t){for(let n in e){let i=e[n];j(i)||Array.isArray(i)?Q(i,t):e[n]=t(i)}}var y=(e,t)=>{for(let n in t){let i=n.split("."),r=i.pop(),o=i.reduce((s,a)=>s[a]??={},e);o[r]=t[n]}return e};function re(e){return e instanceof HTMLElement||e instanceof SVGElement}function se(e){return e?.closest("[data-scope]")?.dataset.scope??null}var Ye=e=>e.trim()==="true",T=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").toLowerCase(),q=e=>T(e).replace(/-./g,t=>t[1].toUpperCase()),Z=e=>T(e).replace(/-/g,"_"),un=e=>q(e).replace(/(^.|(?<=\.).)/g,t=>t[0].toUpperCase()),oe=e=>{try{return JSON.parse(e)}catch{return Function(`return (${e})`)()}},dn={kebab:T,snake:Z,pascal:un};function A(e,t){for(let n of t.get("case")||[]){let i=dn[n];i&&(e=i(e))}return e}function M(e,t,n){if(n.has("scoped")){let i=se(t);i&&(e=`${i}.${e}`)}return e}var Xe={type:"attribute",name:"computed",keyReq:"must",valReq:"must",isExpr:!0,onLoad:({key:e,mods:t,rx:n,computed:i,mergePatch:r})=>{e=A(e,t),r(y({},{[e]:i(n)}))}};var et={type:"attribute",name:"effect",keyReq:"denied",valReq:"must",onLoad:({effect:e,rx:t})=>e(t)};var tt={type:"attribute",name:"signals",isExpr:!0,onLoad:({el:e,key:t,mods:n,rx:i,mergePatch:r})=>{let o=n.has("ifmissing");if(t)t=M(A(t,n),e,n),r(y({},{[t]:i()}),{ifMissing:o});else{let s=i(),a={};for(let l in s)a[M(l,e,n)]=s[l];r(y({},a),{ifMissing:o})}}};var pn="https://data-star.dev/errors";function nt(e,t,n={}){let i=new Error;i.name=`${L} ${e} error`;let r=Z(t),o=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),s=JSON.stringify(n,null,2);return i.message=`${t}
More info: ${pn}/${e}/${r}?${o}
Context: ${s}`,i}function G(e,t,n={}){let i={plugin:{name:t.plugin.name,type:t.plugin.type}};return nt("init",e,Object.assign(i,n))}function it(e,t,n={}){let i={plugin:{name:e.plugin.name,type:e.plugin.type},element:{id:e.el.id,tag:e.el.tagName},expression:{rawKey:e.rawKey,key:e.key,value:e.value,fnContent:e.fnContent}};return nt("runtime",t,Object.assign(i,n))}var ae=`${L}-signal-patch`;var ce={},Ae=[],ge=0,le=0,xe=0,$,st=()=>{ge++},ot=()=>{--ge||(ut(),F())},W=e=>mn.bind(0,{previousValue:e,t:e,e:1}),at=Symbol("computed"),ct=e=>{let t=fn.bind(0,{e:17,getter:e});return t[at]=1,t},lt=e=>{let t={p:e,e:2};$&&we(t,$);let n=k(t);try{t.p()}finally{k(n)}return mt.bind(0,t)},Le=e=>{let t=k(void 0);try{return e()}finally{k(t)}},ut=()=>{for(;le<xe;){let e=Ae[le];Ae[le++]=void 0,ft(e,e.e&=-65)}le=0,xe=0},rt=e=>"getter"in e?dt(e):pt(e,e.t),k=e=>{let t=$;return $=e,t},dt=e=>{let t=k(e);gt(e);try{let n=e.t;return n!==(e.t=e.getter(n))}finally{k(t),yt(e)}},pt=(e,t)=>(e.e=1,e.previousValue!==(e.previousValue=t)),Me=e=>{let t=e.e;if(!(t&64)){e.e=t|64;let n=e.s;n?Me(n.o):Ae[xe++]=e}},ft=(e,t)=>{if(t&16||t&32&&vt(e.r,e)){let i=k(e);gt(e);try{e.p()}finally{k(i),yt(e)}return}t&32&&(e.e=t&-33);let n=e.r;for(;n;){let i=n.c,r=i.e;r&64&&ft(i,i.e=r&-65),n=n.n}},fn=e=>{let t=e.e;if(t&16||t&32&&vt(e.r,e)){if(dt(e)){let n=e.s;n&&fe(n)}}else t&32&&(e.e=t&-33);return $&&we(e,$),e.t},mn=(e,...t)=>{if(t.length){let i=t[0];if(e.t!==(e.t=i)){e.e=17;let r=e.s;return r&&(gn(r),ge||ut()),!0}return!1}let n=e.t;if(e.e&16&&pt(e,n)){let i=e.s;i&&fe(i)}return $&&we(e,$),n},mt=e=>{let t=e.r;for(;t;)t=pe(t,e);let n=e.s;n&&pe(n),e.e=0},we=(e,t)=>{let n=t.a;if(n&&n.c===e)return;let i,r=t.e&4;if(r&&(i=n?n.n:t.r,i&&i.c===e)){t.a=i;return}let o=e.f;if(o&&o.o===t&&(!r||bt(o,t)))return;let s=t.a=e.f={c:e,o:t,l:n,n:i,u:o};i&&(i.l=s),n?n.n=s:t.r=s,o?o.i=s:e.s=s},pe=(e,t=e.o)=>{let n=e.c,i=e.l,r=e.n,o=e.i,s=e.u;if(r?r.l=i:t.a=i,i?i.n=r:t.r=r,o?o.u=s:n.f=s,s)s.i=o;else if(!(n.s=o))if("getter"in n){let a=n.r;if(a){n.e=17;do a=pe(a,n);while(a)}}else"previousValue"in n||mt(n);return r},gn=e=>{let t=e.i,n;e:for(;;){let i=e.o,r=i.e;if(r&3&&(r&60?r&12?r&4?!(r&48)&&bt(e,i)?(i.e=r|40,r&=1):r=0:i.e=r&-9|32:r=0:i.e=r|32,r&2&&Me(i),r&1)){let o=i.s;if(o){e=o,o.i&&(n={t,d:n},t=e.i);continue}}if(e=t){t=e.i;continue}for(;n;)if(e=n.t,n=n.d,e){t=e.i;continue e}break}},gt=e=>{e.a=void 0,e.e=e.e&-57|4},yt=e=>{let t=e.a,n=t?t.n:e.r;for(;n;)n=pe(n,e);e.e&=-5},vt=(e,t)=>{let n,i=0;e:for(;;){let r=e.c,o=r.e,s=!1;if(t.e&16)s=!0;else if((o&17)===17){if(rt(r)){let a=r.s;a.i&&fe(a),s=!0}}else if((o&33)===33){(e.i||e.u)&&(n={t:e,d:n}),e=r.r,t=r,++i;continue}if(!s&&e.n){e=e.n;continue}for(;i;){--i;let a=t.s,l=a.i;if(l?(e=n.t,n=n.d):e=a,s){if(rt(t)){l&&fe(a),t=e.o;continue}}else t.e&=-33;if(t=e.o,e.n){e=e.n;continue e}s=!1}return s}},fe=e=>{do{let t=e.o,n=e.i,i=t.e;(i&48)===32&&(t.e=i|16,i&2&&Me(t)),e=n}while(e)},bt=(e,t)=>{let n=t.a;if(n){let i=t.r;do{if(i===e)return!0;if(i===n)break;i=i.n}while(i)}return!1},Ce=e=>e.split(".").reduce((t,n)=>t[n],P),ht=e=>Le(()=>e.split(".").reduce((t,n)=>t&&Object.hasOwn(t,n)?t[n]:void 0,P)!==void 0),ue=(e,t="")=>{let n=Array.isArray(e);if(n||j(e)){let i=n?[]:{};for(let o in e)i[o]=W(ue(e[o],`${t+o}.`));let r=W(0);return new Proxy(i,{get:(o,s)=>{if(!(s==="toJSON"&&!Object.hasOwn(i,s)))return n&&s in Array.prototype?(r(),i[s]):(Object.hasOwn(i,s)||(i[s]=W(""),F({[t+s]:""}),r(r()+1)),i[s]())},set:(o,s,a)=>{if(n&&s==="length")return i[s]=a,F({[t.slice(0,-1)]:i}),r(r()+1),!0;if(Object.hasOwn(i,s)){if(a==null)return delete i[s],F({[t+s]:null}),r(r()+1),!0;i[s](ue(a,`${t+s}.`))&&F({[t+s]:a})}else{if(a==null)return!0;Object.hasOwn(a,at)?(i[s]=a,F({[t+s]:""})):(i[s]=W(ue(a,`${t+s}.`)),F({[t+s]:a})),r(r()+1)}return!0},deleteProperty:(o,s)=>(Object.hasOwn(i,s)&&(delete i[s],F({[t+s]:null}),r(r()+1)),!0),ownKeys:()=>(r(),Reflect.ownKeys(i)),has(o,s){return r(),s in i}})}return e},F=e=>{if(e&&y(ce,e),!ge&&!Ze(ce)){let t=ce;ce={},document.dispatchEvent(new CustomEvent(ae,{detail:t}))}},Et=(e,{ifMissing:t}={})=>{st();for(let n in e)e[n]===null||e[n]===void 0?t||delete P[n]:St(e[n],n,P,"",t);ot()},St=(e,t,n,i,r)=>{if(j(e)){Object.hasOwn(n,t)&&(j(n[t])||Array.isArray(n[t]))||(n[t]={});for(let o in e)e[o]===null||e[o]===void 0?r||delete n[t][o]:St(e[o],o,n[t],`${i+t}.`,r)}else r&&Object.hasOwn(n,t)||(n[t]=e)};function Rt({include:e=/.*/,exclude:t=/(?!)/}={},n=P){let i=RegExp(e),r=RegExp(t),o={},s=[[n,""]];for(;s.length;){let[a,l]=s.pop();for(let c in a)j(a[c])?s.push([a[c],`${l+c}.`]):i.test(l+c)&&!r.test(l+c)&&(o[l+c]=Ce(l+c))}return y({},o)}var P=ue({}),X={},de=[],Tt=[],Y=new Map,Te=null,ee="";function At(e){ee=e}function w(e){return ee?`data-${ee}-${e}`:`data-${e}`}function ye(...e){for(let t of e){let n={plugin:t,actions:X,root:P,filtered:Rt,signal:W,computed:ct,effect:lt,mergePatch:Et,peek:Le,getPath:Ce,hasPath:ht};if(t.type==="action")X[t.name]=t;else if(t.type==="attribute")de.push(t),t.onGlobalInit?.(n);else if(t.type==="watcher")t.onGlobalInit?.(n);else throw G("InvalidPluginType",n)}de.sort((t,n)=>{let i=n.name.length-t.name.length;return i!==0?i:t.name.localeCompare(n.name)}),Tt=de.map(t=>RegExp(`^${t.name}([A-Z]|_|$)`))}function me(e){for(let t of e)for(let n in t.dataset)xt(t,n,t.dataset[n])}function Oe(e=document.body){queueMicrotask(()=>{me([e]),me(e.querySelectorAll("*")),Te||(Te=new MutationObserver(yn),Te.observe(e,{subtree:!0,childList:!0,attributes:!0}))})}function xt(e,t,n){let i=q(ee?t.slice(ee.length):t),r=de.find((o,s)=>Tt[s].test(i));if(r){let[o,...s]=i.slice(r.name.length).split(/__+/),a=!!o;a&&(o=q(o));let l=!!n,c={el:e,rawKey:i,key:o,value:n,mods:new Map,root:P,filtered:Rt,mergePatch:Et,signal:W,computed:ct,effect:lt,plugin:r,actions:X,peek:Le,getPath:Ce,hasPath:ht,runtimeErr:0,rx:0};c.runtimeErr=it.bind(0,c),c.rx=vn(c);let f=r.keyReq||"allowed";if(a){if(f==="denied")throw c.runtimeErr(`${r.name}KeyNotAllowed`)}else if(f==="must")throw c.runtimeErr(`${r.name}KeyRequired`);let p=r.valReq||"allowed";if(l){if(p==="denied")throw c.runtimeErr(`${r.name}ValueNotAllowed`)}else if(p==="must")throw c.runtimeErr(`${r.name}ValueRequired`);if(f==="exclusive"||p==="exclusive"){if(a&&l)throw c.runtimeErr(`${r.name}KeyAndValueProvided`);if(!a&&!l)throw c.runtimeErr(`${r.name}KeyOrValueRequired`)}for(let d of s){let[v,...g]=d.split(".");c.mods.set(q(v),new Set(g.map(m=>m.toLowerCase())))}st();let u=r.onLoad(c);if(ot(),u){let d=Y.get(e);d?d.get(i)?.():(d=new Map,Y.set(e,d)),d.set(i,u)}}}function yn(e){let t=`[${w("ignore")}]`;for(let{target:n,type:i,attributeName:r,addedNodes:o,removedNodes:s}of e)if(i==="childList"){for(let a of s)if(re(a)){let l=Y.get(a);if(Y.delete(a)){for(let c of l.values())c();l.clear()}}for(let a of o)re(a)&&(me([a]),me(a.querySelectorAll("*")))}else if(i==="attributes"&&re(n)&&!n.closest(t)){let a=q(r.slice(5)),l=n.getAttribute(r);if(l===null){let c=Y.get(n);c&&(c.get(a)?.(),c.delete(a))}else xt(n,a,l)}}function vn(e){let t="",n=e.plugin||void 0;if(n?.isExpr){let p=/(\/(\\\/|[^/])*\/|"(\\"|[^"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;){]*)\s*\)\s*\(\s*\)|[^;])+/gm,u=e.value.trim().match(p);if(u){let d=u.length-1,v=u[d].trim();v.startsWith("return")||(u[d]=`return (${v});`),t=u.join(`;
`)}}else t=e.value.trim();t=t.replace(/\$\$([a-zA-Z_][\w.-]*(?:\.[a-zA-Z_][\w.-]*)*?)(?=\s|$|[^\w.-])/g,(p,u)=>{let d=se(e.el);return d?`$${d}.${u}`:`$${u}`}),t=t.replace(/\$([a-zA-Z_][\w.-]*(?:\.[a-zA-Z_][\w.-]*)*?)(?=\s|$|[^\w.-])/g,(p,u)=>u.endsWith("-")&&p.length<t.length&&t[t.indexOf(p)+p.length]==="$"?(u=u.slice(0,-1),`${u.split(".").reduce((g,m)=>`${g}['${m}']`,"$")}-`):u.split(".").reduce((v,g)=>`${v}['${g}']`,"$"));let i=new Map,r=RegExp(`(?:${ie})(.*?)(?:${Se})`,"gm");for(let p of t.matchAll(r)){let u=p[1],d=`dsEscaped${bn(u)}`;i.set(d,u),t=t.replace(ie+u+Se,d)}let o=(p,u)=>`${p}${Z(u).replaceAll(/\./g,"_")}`,s=new Set,a=RegExp(`@(${Object.keys(X).join("|")})\\(`,"gm"),l=[...t.matchAll(a)],c=new Set,f=new Set;if(l.length){let p=`${L}Act_`;for(let u of l){let d=u[1],v=X[d];if(!v)continue;s.add(d);let g=o(p,d);t=t.replace(`@${d}(`,`${g}(`),c.add(g),f.add((...m)=>v.fn(e,...m))}}for(let[p,u]of i)t=t.replace(p,u);e.fnContent=t;try{let p=Function("el","$",...n?.argNames||[],...c,t);return(...u)=>{try{return p(e.el,P,...u,...f)}catch(d){throw e.runtimeErr("ExecuteExpression",{error:d.message})}}}catch(p){throw e.runtimeErr("GenerateExpression",{error:p.message})}}function bn(e){let t=5831,n=e.length;for(;n--;)t+=(t<<5)+e.charCodeAt(n);return(t>>>0).toString(36)}ye(tt,Xe,et);var Lt={type:"action",name:"peek",fn:({peek:e},t)=>e(t)};var Mt={type:"action",name:"setAll",fn:({filtered:e,mergePatch:t,peek:n},i,r)=>{n(()=>{let o=e(r);Q(o,()=>i),t(o)})}};var wt={type:"action",name:"toggleAll",fn:({filtered:e,mergePatch:t,peek:n},i)=>{n(()=>{let r=e(i);Q(r,o=>!o),t(r)})}};var Ct={type:"attribute",name:"attr",valReq:"must",isExpr:!0,onLoad:({el:e,effect:t,key:n,rx:i})=>{let r=(l,c)=>{c===""||c===!0?e.setAttribute(l,""):c===!1||c===null||c===void 0?e.removeAttribute(l):e.setAttribute(l,c)};if(n===""){let l=new MutationObserver(()=>{l.disconnect();let f=i();for(let[p,u]of Object.entries(f))r(p,u);l.observe(e,{attributeFilter:Object.keys(f)})}),c=t(()=>{l.disconnect();let f=i();for(let p in f)r(p,f[p]);l.observe(e,{attributeFilter:Object.keys(f)})});return()=>{l.disconnect(),c()}}let o=T(n),s=new MutationObserver(()=>{s.disconnect();let l=i();r(o,l),s.observe(e,{attributeFilter:[l]})}),a=t(()=>{s.disconnect();let l=i();r(o,l),s.observe(e,{attributeFilter:[l]})});return()=>{s.disconnect(),a()}}};var hn=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,En=/email|password|search|tel|text|url/,Sn=/number|range/,Ot={type:"attribute",name:"bind",keyReq:"exclusive",valReq:"exclusive",onLoad:({el:e,key:t,mods:n,value:i,effect:r,mergePatch:o,runtimeErr:s,getPath:a,hasPath:l})=>{let c=t?A(t,n):i;if(c=M(c,e,n),e instanceof HTMLInputElement&&En.test(e.type)||e instanceof HTMLTextAreaElement){if(Array.isArray(l(c)&&a(c))){let v=n.has("scoped")?"__scoped":"",g=document.querySelectorAll(`[${w("bind")}${v}-${t}],[${w("bind")}${v}="${i}"]`),m=0,b={};for(let R of g){if(l(`${c}.${m}`)||(b[`${c}.${m}`]=R.value),e===R)break;m++}o(y({},b));let E=()=>{o(y({},{[`${c}.${m}`]:e.value}))};e.addEventListener("change",E),e.addEventListener("input",E);let h=r(()=>e.value=a(c)[m]);return()=>{h(),e.removeEventListener("change",E),e.removeEventListener("input",E)}}o(y({},{[c]:e.value}),{ifMissing:!0});let u=()=>o(y({},{[c]:e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let d=r(()=>e.value=a(c));return()=>{d(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}if(e instanceof HTMLInputElement){if(e.type==="checkbox"){if(Array.isArray(l(c)&&a(c))){let g=n.has("scoped")?"__scoped":"",m=document.querySelectorAll(`[${w("bind")}${g}-${t}],[${w("bind")}${g}="${i}"]`),b=0,E={};for(let S of m){if(!l(`${c}.${b}`)){let ne=S.getAttribute("value");E[`${c}.${b}`]=ne?S.checked?ne:"":S.checked}if(e===S)break;b++}o(y({},E));let h=()=>{let S=e.getAttribute("value");o(y({},{[`${c}.${b}`]:S?e.checked?S:"":e.checked}))};e.addEventListener("change",h),e.addEventListener("input",h);let R=r(()=>{let S=e.getAttribute("value");e.checked=S?S===a(c)[b]:a(c)[b]});return()=>{R(),e.removeEventListener("change",h),e.removeEventListener("input",h)}}let u=e.getAttribute("value");o(y({},{[c]:u?e.checked?u:"":e.checked}));let d=()=>{let g=e.getAttribute("value");o(y({},{[c]:g?e.checked?g:"":e.checked}))};e.addEventListener("change",d),e.addEventListener("input",d);let v=r(()=>{let g=e.getAttribute("value");e.checked=g?g===a(c):a(c)});return()=>{v(),e.removeEventListener("change",d),e.removeEventListener("input",d)}}if(e.type==="radio"){e.getAttribute("name")?.length||e.setAttribute("name",c),o(y({},{[c]:e.value}),{ifMissing:!0});let u=()=>e.checked&&o(y({},{[c]:e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let d=r(()=>e.checked=e.value===a(c));return()=>{d(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}if(Sn.test(e.type)){o(y({},{[c]:+e.value}),{ifMissing:!0});let u=()=>o(y({},{[c]:+e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let d=r(()=>e.value=a(c));return()=>{d(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}if(e.type==="file"){let u=()=>{let d=[...e.files||[]],v=[],g=[],m=[];Promise.all(d.map(b=>new Promise(E=>{let h=new FileReader;h.onload=()=>{if(typeof h.result!="string")throw s("InvalidFileResultType",{resultType:typeof h.result});let R=h.result.match(hn);if(!R?.groups)throw s("InvalidDataUri",{result:h.result});v.push(R.groups.contents),g.push(R.groups.mime),m.push(b.name)},h.onloadend=()=>E(),h.readAsDataURL(b)}))).then(()=>{o(y({},{[c]:v,[`${c}Mimes`]:g,[`${c}Names`]:m}))})};return e.addEventListener("change",u),e.addEventListener("input",u),()=>{e.removeEventListener("change",u),e.removeEventListener("input",u)}}}if(e instanceof HTMLSelectElement){if(e.multiple){o(y({},{[c]:[...e.selectedOptions].map(b=>b.value)}),{ifMissing:!0});let g=()=>o(y({},{[c]:[...e.selectedOptions].map(b=>b.value)}));e.addEventListener("change",g),e.addEventListener("input",g);let m=r(()=>{let b=a(c);for(let E of e.options)E.selected=b.includes(E.value)});return()=>{m(),e.removeEventListener("change",g),e.removeEventListener("input",g)}}o(y({},{[c]:e.value}),{ifMissing:!0});let u=()=>o(y({},{[c]:e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let v=r(()=>e.value=a(c));return()=>{v(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}o(y({},{[c]:e.getAttribute("value")}),{ifMissing:!0});let f=new MutationObserver(()=>{o(y({},{[c]:e.getAttribute("value")}))});f.observe(e,{attributeFilter:["value"]});let p=r(()=>e.setAttribute("value",a(c)));return()=>{p(),f.disconnect()}}};var Ft={type:"attribute",name:"class",valReq:"must",isExpr:!0,onLoad:({key:e,el:t,effect:n,mods:i,rx:r})=>{if(e===""){let l=new MutationObserver(()=>{l.disconnect();let f=r();for(let[p,u]of Object.entries(f)){let d=p.split(/\s+/);u?t.classList.add(...d):t.classList.remove(...d)}l.observe(t,{attributeFilter:["class"]})}),c=n(()=>{l.disconnect();let f=r();for(let[p,u]of Object.entries(f)){let d=p.split(/\s+/);u?t.classList.add(...d):t.classList.remove(...d)}l.observe(t,{attributeFilter:["class"]})});return()=>{l.disconnect(),c()}}let o=T(e);o=A(o,i);let s=new MutationObserver(()=>{s.disconnect(),r()?t.classList.add(o):t.classList.remove(o),s.observe(t,{attributeFilter:["class"]})}),a=n(()=>{s.disconnect(),r()?t.classList.add(o):t.classList.remove(o),s.observe(t,{attributeFilter:["class"]})});return()=>{s.disconnect(),a()}}};var D=`${L}-sse`,ve="started",be="finished",$t="error",kt="retrying",Pt="retrying";function he(e,t){document.addEventListener(D,n=>{if(n.detail.type===e){let{argsRaw:i}=n.detail;t(i)}})}var Dt={type:"attribute",name:"indicator",keyReq:"exclusive",valReq:"exclusive",onLoad:({el:e,key:t,mods:n,mergePatch:i,value:r})=>{let o=t?A(t,n):r;o=M(o,e,n),i(y({},{[o]:!1}),{ifMissing:!0});let s=a=>{let{type:l,el:c}=a.detail;if(c===e)switch(l){case ve:i(y({},{[o]:!0}));break;case be:i(y({},{[o]:!1}));break}};return document.addEventListener(D,s),()=>{i(y({},{[o]:!1})),document.removeEventListener(D,s)}}};var It={type:"attribute",name:"jsonSignals",keyReq:"denied",onLoad:({el:e,effect:t,value:n,filtered:i,mods:r})=>{let o=r.has("terse")?0:2,s={};n&&(s=oe(n));let a=()=>{l.disconnect(),e.textContent=JSON.stringify(i(s),null,o),l.observe(e,{childList:!0})},l=new MutationObserver(a),c=t(a);return()=>{l.disconnect(),c()}}};function I(e){if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return+t.replace("ms","");if(t.endsWith("s"))return+t.replace("s","")*1e3;try{return Number.parseFloat(t)}catch{}}return 0}function N(e,t,n=!1){return e?e.has(t.toLowerCase()):n}function Fe(e,t){return(...n)=>{setTimeout(()=>{e(...n)},t)}}function Rn(e,t,n=!1,i=!0){let r=0;return(...o)=>{r&&clearTimeout(r),n&&!r&&e(...o),r=setTimeout(()=>{i&&e(...o),r&&clearTimeout(r)},t)}}function Tn(e,t,n=!0,i=!1){let r=!1;return(...o)=>{r||(n&&e(...o),r=!0,setTimeout(()=>{r=!1,i&&e(...o)},t))}}function Ee(e,t){let n=t.get("delay");if(n){let o=I(n);e=Fe(e,o)}let i=t.get("debounce");if(i){let o=I(i),s=N(i,"leading",!1),a=!N(i,"notrail",!1);e=Rn(e,o,s,a)}let r=t.get("throttle");if(r){let o=I(r),s=!N(r,"noleading",!1),a=N(r,"trail",!1);e=Tn(e,o,s,a)}return e}var $e=!!document.startViewTransition;function H(e,t){if(t.has("viewtransition")&&$e){let n=e;e=(...i)=>document.startViewTransition(()=>n(...i))}return e}var Ht={type:"attribute",name:"on",keyReq:"must",valReq:"must",argNames:["evt"],onLoad:e=>{let{el:t,key:n,mods:i,rx:r}=e,o=t;i.has("window")&&(o=window);let s=c=>{if(c){if(i.has("prevent")&&c.preventDefault(),i.has("stop")&&c.stopPropagation(),!(c.isTrusted||c instanceof CustomEvent||i.has("trust")))return;e.evt=c}r(c)};s=Ee(s,i),s=H(s,i);let a={capture:i.has("capture"),passive:i.has("passive"),once:i.has("once")};if(i.has("outside")){o=document;let c=s;s=f=>{t.contains(f?.target)||c(f)}}let l=T(n);if(l=A(l,i),(l===D||l===ae)&&(o=document),t instanceof HTMLFormElement&&l==="submit"){let c=s;s=f=>{f?.preventDefault(),c(f)}}return o.addEventListener(l,s,a),()=>{o.removeEventListener(l,s)}}};var ke=new WeakSet,_t={type:"attribute",name:"onIntersect",keyReq:"denied",onLoad:({el:e,mods:t,rx:n})=>{let i=()=>n();i=Ee(i,t),i=H(i,t);let r={threshold:0};t.has("full")?r.threshold=1:t.has("half")&&(r.threshold=.5);let o=new IntersectionObserver(s=>{for(let a of s)a.isIntersecting&&(i(),o&&ke.has(e)&&o.disconnect())},r);return o.observe(e),t.has("once")&&ke.add(e),()=>{t.has("once")||ke.delete(e),o&&(o.disconnect(),o=null)}}};var Vt={type:"attribute",name:"onInterval",keyReq:"denied",valReq:"must",onLoad:({mods:e,rx:t})=>{let n=()=>t();n=H(n,e);let i=1e3,r=e.get("duration");r&&(i=I(r),N(r,"leading",!1)&&n());let o=setInterval(n,i);return()=>{clearInterval(o)}}};var Nt={type:"attribute",name:"onLoad",keyReq:"denied",valReq:"must",onLoad:({rx:e,mods:t,mergePatch:n})=>{let i=()=>{let s=e();return n({}),s};i=H(i,t);let r=0,o=t.get("delay");o&&(r=I(o)),i=Fe(i,r),i()}};var jt={type:"attribute",name:"ref",keyReq:"exclusive",valReq:"exclusive",onLoad:({key:e,mods:t,value:n,el:i,mergePatch:r})=>{let o=e?A(e,t):n;o=M(o,i,t),r(y({},{[o]:i}))}};var qt={type:"attribute",name:"scope",keyReq:"denied",onLoad:({el:e,value:t,mods:n,mergePatch:i})=>{let r=t||`_${crypto.randomUUID()}`;e.parentElement&&(r=M(r,e.parentElement,n));let o=r.split(".").reduceRight((s,a)=>({[a]:s}),{});return i(o),e.setAttribute("data-scope",r),e.removeAttribute("data-scope__scoped"),()=>{let a=r.split(".").reduceRight((l,c)=>({[c]:l}),null);i(a)}}};var Gt="none",Wt="display",Kt={type:"attribute",name:"show",keyReq:"denied",valReq:"must",isExpr:!0,onLoad:({el:e,effect:t,rx:n})=>{let i=()=>{r.disconnect(),n()?e.style.display===Gt&&e.style.removeProperty(Wt):e.style.setProperty(Wt,Gt),r.observe(e,{attributeFilter:["style"]})},r=new MutationObserver(i),o=t(i);return()=>{r.disconnect(),o()}}};var Ut={type:"attribute",name:"text",keyReq:"denied",valReq:"must",isExpr:!0,onLoad:({el:e,effect:t,rx:n})=>{let i=()=>{r.disconnect(),e.textContent=`${n()}`,r.observe(e,{childList:!0})},r=new MutationObserver(i),o=t(i);return()=>{r.disconnect(),o()}}};var An=e=>`${e}`.includes("text/event-stream"),_=(e,t,n)=>document.dispatchEvent(new CustomEvent(D,{detail:{type:e,el:t,argsRaw:n}}));function xn(e,t){let n={Accept:"text/event-stream, text/html, application/json",[Ne]:!0};return e==="json"&&(n["Content-Type"]="application/json"),Object.assign({},n,t)}function Ln(e,t,n,i){let{el:r,evt:o,runtimeErr:s}=e,a=()=>{};if(!i)throw s(t?"FormNotFound":"ClosestFormNotFound",{method:n,selector:t});if(!i.checkValidity())return i.reportValidity(),{body:null,headers:{},cleanup:a};let l=new FormData(i),c=r;if(r===i&&o instanceof SubmitEvent)c=o.submitter;else{let d=v=>v.preventDefault();i.addEventListener("submit",d),a=()=>i.removeEventListener("submit",d)}if(c instanceof HTMLButtonElement){let d=c.getAttribute("name");d&&l.append(d,c.value)}let f=i.getAttribute("enctype")==="multipart/form-data",p={},u=null;return n.toUpperCase()==="GET"?u=null:f?u=l:(p["Content-Type"]="application/x-www-form-urlencoded",u=new URLSearchParams(l)),{body:u,headers:p,cleanup:a}}var Bt=async({el:e,evt:t,filtered:n,runtimeErr:i},r,o,{selector:s,headers:a,contentType:l="json",filterSignals:c={include:/.*/,exclude:/(^|\.)_/},openWhenHidden:f=!1,retryInterval:p=je,retryScaler:u=2,retryMaxWaitMs:d=3e4,retryMaxCount:v=10,abort:g}={})=>{let m=r.toLowerCase(),b=()=>{};try{if(!o?.length)throw i("SseNoUrlProvided",{action:m});let E=xn(l,a),h=new URL(o,window.location.href),R=new URLSearchParams(h.search),S=null;if(l==="json"){let O=JSON.stringify(n(c));r==="GET"?R.set(L,O):S=O}else if(l==="form"){let O=s?document.querySelector(s):e.closest("form"),V=Ln({el:e,evt:t,filtered:n,runtimeErr:i},s,r,O);if(b=V.cleanup,!V.body&&r.toUpperCase()!=="GET")return;if(Object.assign(E,V.headers),r==="GET"&&V.body instanceof URLSearchParams)for(let[Ie,He]of V.body)R.append(Ie,He);else S=V.body}else throw i("SseInvalidContentType",{action:m,contentType:l});let ne;_(ve,e,{}),h.search=R.toString();try{await Mn(h.toString(),e,{method:r,headers:E,body:S,signal:g,openWhenHidden:f,retryInterval:p,retryScaler:u,retryMaxWaitMs:d,retryMaxCount:v,duplex:ne})}catch(O){if(!An(O))throw i("SseFetchFailed",{method:r,url:o,error:O})}}finally{_(be,e,{}),b()}};async function Mn(e,t,n){let{signal:i,openWhenHidden:r=!1,retryInterval:o=1e3,retryScaler:s=2,retryMaxWaitMs:a=3e4,retryMaxCount:l=10,...c}=n,f=0,p=o,u=new AbortController,d=()=>{document.hidden&&!r&&u.abort()};document.addEventListener("visibilitychange",d);let v=()=>{document.removeEventListener("visibilitychange",d),u.abort()};i?.addEventListener("abort",v);async function g(){u=new AbortController;try{let m=await fetch(e,{...c,signal:u.signal});m.status>=400&&_($t,t,{status:m.status.toString()}),f=0,p=o;let b=m.headers.get("Content-Type");if(b?.includes("text/html")){let h={elements:await m.text()};for(let R of["selector","mode","useViewTransition"]){let S=m.headers.get(`datastar-${T(R)}`);S&&(h[R]=S)}_(J,t,h)}else if(b?.includes("application/json")){let h={signals:await m.text()};for(let R of["onlyIfMissing","mode","useViewTransition"]){let S=m.headers.get(`datastar-${T(R)}`);S&&(h[R]=S)}_(z,t,h)}else if(b?.includes("text/javascript")){let E=document.createElement("script"),h=m.headers.get("datastar-script-attributes");if(h)for(let[R,S]of Object.entries(JSON.parse(h)))E.setAttribute(R,S);E.textContent=await m.text(),document.head.appendChild(E)}else await wn(m,t,E=>{p=E});v()}catch(m){if(!u.signal.aborted){if(++f>=l)throw _(Pt,t,{}),v(),new Error("Max retries reached");return _(kt,t,{message:`${m}`}),p=Math.min(p*s,a),await new Promise(b=>setTimeout(b,p)),g()}}}return g()}async function wn(e,t,n){let i=e.body.getReader(),r=new TextDecoder,o="";for(;;){let{done:s,value:a}=await i.read();if(s)break;o+=r.decode(a,{stream:!0});let l=o.split(`
`);o=l.pop()||"";let c=0;for(;c<l.length;){let f="",p=[],u;for(;c<l.length&&l[c].length>0;){let d=l[c];if(d.startsWith("event:"))f=d.slice(6).trimStart();else if(d.startsWith("data:"))p.push(d.slice(5).trimStart());else if(d.startsWith("retry:")){let v=Number.parseInt(d.slice(6).trimStart());Number.isNaN(v)||(u=v)}c++}if(f.includes(L)&&p.length>0){let d={};for(let g of p){let m=g.indexOf(" ");if(m>0){let b=g.slice(0,m),E=g.slice(m+1);d[b]||(d[b]=[]),d[b].push(E)}}let v={};for(let[g,m]of Object.entries(d))v[g]=m.join(`
`);_(f,t,v)}u!==void 0&&n(u),c++}}}var C=(e,t)=>({type:"action",name:e,fn:(n,i,r)=>Bt(n,t,i,r)});var Jt=C("delete","DELETE");var zt=C("get","GET");var Qt=C("patch","PATCH");var Zt=C("post","POST");var Yt=C("put","PUT");var nn={type:"watcher",name:J,async onGlobalInit(e){he(J,t=>Cn(e,t))}};function Cn(e,{elements:t,selector:n,mode:i=Qe,useViewTransition:r}){let o=document.createElement("template");o.innerHTML=t;for(let s of[...o.content.childNodes]){let a=s.nodeType;if(a!==1){if(a===3&&!s.nodeValue.trim())continue;throw G("NoElementsFound",e)}let l=n||`#${s.id}`,c=document.querySelectorAll(l);if(!c.length)throw G("NoTargetsFound",e,{selectorOrId:l});r&&$e?document.startViewTransition(()=>Xt(e,i,s,c)):Xt(e,i,s,c)}}function Xt(e,t,n,i){for(let r of i){if(t===We)r.remove();else if(t===Re||t===Ge)On(r,n,t);else{let s=n.cloneNode(!0);if(t===Ke)r.replaceWith(s);else if(t===Ue)r.prepend(s);else if(t===Be)r.append(s);else if(t===Je)r.before(s);else if(t===ze)r.after(s);else throw G("InvalidPatchMode",e,{mode:t})}let o=r instanceof HTMLScriptElement?[r]:r.querySelectorAll("script");for(let s of o){let a=document.createElement("script");for(let{name:l,value:c}of s.attributes)a.setAttribute(l,c);a.text=s.text,s.replaceWith(a)}}}var K=new Map,x=new Map,U=new Set,te=new Set,B=document.createElement("div");B.hidden=!0;function On(e,t,n){let i=w("ignore-morph");if(e.hasAttribute(i)&&t.hasAttribute(i)||e.parentElement?.closest(`[${i}]`))return;let r=document.createElement("div");r.append(t),document.body.insertAdjacentElement("afterend",B);let o=e.querySelectorAll("[id]");for(let{id:a,tagName:l}of o)K.has(a)?te.add(a):K.set(a,l);e.id&&(K.has(e.id)?te.add(e.id):K.set(e.id,e.tagName)),U.clear();let s=r.querySelectorAll("[id]");for(let{id:a,tagName:l}of s)U.has(a)?te.add(a):K.get(a)===l&&U.add(a);K.clear();for(let a of te)U.delete(a);te.clear(),x.clear(),tn(n==="outer"?e.parentElement:e,o),tn(r,s),rn(n==="outer"?e.parentElement:e,r,n==="outer"?e:null,e.nextSibling),B.remove()}function rn(e,t,n=null,i=null){e instanceof HTMLTemplateElement&&t instanceof HTMLTemplateElement&&(e=e.content,t=t.content),n??=e.firstChild;for(let r of t.childNodes){if(n&&n!==i){let s=Fn(r,n,i);if(s){if(s!==n){let a=n;for(;a&&a!==s;){let l=a;a=a.nextSibling,De(l)}}Pe(s,r),n=s.nextSibling;continue}}let o=r.id;if(r instanceof Element&&U.has(o)){let s=window[o],a=s;for(;a=a.parentNode;){let l=x.get(a);l&&(l.delete(o),l.size||x.delete(a))}sn(e,s,n),Pe(s,r),n=s.nextSibling;continue}if(x.has(r)){let s=document.createElement(r.tagName);e.insertBefore(s,n),Pe(s,r),n=s.nextSibling}else{let s=document.importNode(r,!0);e.insertBefore(s,n),n=s.nextSibling}}for(;n&&n!==i;){let r=n;n=n.nextSibling,De(r)}}function Fn(e,t,n){let i=null,r=e.nextSibling,o=0,s=0,a=x.get(e)?.size||0,l=t;for(;l&&l!==n;){if(en(l,e)){let c=!1,f=x.get(l),p=x.get(e);if(p&&f){for(let u of f)if(p.has(u)){c=!0;break}}if(c)return l;if(!i&&!x.has(l)){if(!a)return l;i=l}}if(s+=x.get(l)?.size||0,s>a||(i===null&&r&&en(l,r)&&(o++,r=r.nextSibling,o>=2&&(i=void 0)),l.contains(document.activeElement)))break;l=l.nextSibling}return i||null}function en(e,t){let n=e.id;return e.nodeType===t.nodeType&&e.tagName===t.tagName&&(!n||n===t.id)}function De(e){x.has(e)?sn(B,e,null):e.parentNode?.removeChild(e)}var sn=De.call.bind(B.moveBefore??B.insertBefore);function Pe(e,t){let n=t.nodeType;if(n===1){let i=w("ignore-morph");if(e.hasAttribute(i)&&t.hasAttribute(i))return e;let r=t.getAttribute(w("preserve-attr"))?.split(" ");for(let{name:s,value:a}of t.attributes)e.getAttribute(s)!==a&&!r?.includes(T(s))&&e.setAttribute(s,a);let o=e.attributes;for(let s=o.length-1;s>=0;s--){let{name:a}=o[s];!t.hasAttribute(a)&&!r?.includes(T(a))&&e.removeAttribute(a)}if(e instanceof HTMLInputElement&&t instanceof HTMLInputElement&&t.type!=="file"){let s=w("bind").slice(5),a=!0;for(let l in t.dataset)if(l.startsWith(s)){a=!1;break}if(a){let l=t.value;t.hasAttribute("value")?e.value!==l&&(e.setAttribute("value",l),e.value=l):(e.value="",e.removeAttribute("value"))}}else if(e instanceof HTMLTextAreaElement&&t instanceof HTMLTextAreaElement){let s=t.value;s!==e.value&&(e.value=s),e.firstChild&&e.firstChild.nodeValue!==s&&(e.firstChild.nodeValue=s)}}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),e.isEqualNode(t)||rn(e,t),e}function tn(e,t){for(let n of t)if(U.has(n.id)){let i=n;for(;i&&i!==e;){let r=x.get(i);r||(r=new Set,x.set(i,r)),r.add(n.id),i=i.parentElement}}}var on={type:"watcher",name:z,onGlobalInit:e=>he(z,({signals:t="{}",onlyIfMissing:n=`${qe}`})=>e.mergePatch(oe(t),{ifMissing:Ye(n)}))};ye(zt,Zt,Yt,Qt,Jt,nn,on,Ct,Ot,Ft,Dt,It,Ht,_t,Vt,Nt,jt,qt,Kt,Ut,Lt,Mt,wt);Oe();export{Oe as apply,ye as load,At as setAlias};
//# sourceMappingURL=datastar.js.map
